- A Region Proposal Network, or RPN, is a fully convolutional network that simultaneously predicts object bounds and objectness scores at each position. The RPN is trained end-to-end to generate high-quality region proposals.
- RPN is used to decide “where” to look in order to reduce the computational requirements of the overall inference process. The RPN quickly and efficiently scans every location in order to assess whether further processing needs to be carried out in a given region.
- It does that by outputting k bounding box proposals each with 2 scores representing probability of object or not at each location. In other words, it is used to find up to a predefined number(~2000) of regions (bounding boxes), which may contain objects.
- The steps in RPN:
	- Generate anchor boxes.
	- Classify each anchor box whether it is foreground or background.
	- Learn the shape offsets for anchor boxes to fit them for objects.
![[1 WJsEQnhr4puR4k-29uD80Q.webp|center]]
- Anchor point: Every point in the feature map generated by the backbone network is an anchor point. We need to generate anchor boxes for every anchor point. We generate candidate boxes using two parameters — scales and aspect ratios. The boxes need to be at image dimensions, whereas the feature map is reduced depending on the backbone. For those who don’t know, aspect ratio = width of image/height of image, scale is the size of the image. By default we use 3 scales and 3 aspect ratios, yielding k = 9 anchors at each sliding position.
![[1 FifNx4NCyynAZqLjVtB5Ow.webp|center]]
- Now we have generated the anchor boxes, but these are dummy boxes that are different from the actual object of interest. Also, there might be many boxes which are not having any object in it. So we need to learn whether the given box is foreground or background, at the same time we need to learn the offsets for the foreground boxes to adjust for fitting the objects. These two tasks are achieved by two convolution layers on the feature map obtained from the backbone network. Those layers are rpn_cls_score and rpn_bbox_pred and the architecture looks like below.
![[1 hdny9cskat-RjUPuq5ze4A.webp|center]]